{"version":3,"file":"toggle_filter_checkbox.min.js","sources":["../src/toggle_filter_checkbox.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript to toggle filter checkbox.\n *\n * @module    mod_studentquiz/toggle_filter_checkbox\n * @copyright 2019 The Open University\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'core/key_codes'], function($, keyCodes) {\n    var t = {\n\n        SELECTOR: {\n            TIME_EDT: {\n                CALENDAR: \"a[name='timecreated_edt[calendar]\",\n                SELECT_DAY_CALENDAR: \"select[name='timecreated_edt[day]\",\n                INPUT: \"input[name='timecreated_edt[enabled]']\"\n            },\n            TIME_SDT: {\n                CALENDAR: \"a[name='timecreated_sdt[calendar]\",\n                SELECT_DAY_CALENDAR: \"select[name='timecreated_sdt[day]\",\n                INPUT: \"input[name='timecreated_sdt[enabled]']\"\n            }\n        },\n\n        /**\n         * Elements (jQuery) are depend on hidden checkboxes.\n         * They will disable if the checkbox is checked.\n         */\n        dependencies: [],\n\n        /**\n         * Initialise events on link-toggle.\n         */\n        init: function() {\n            var linkToggles = $('a.link-toggle');\n\n            linkToggles.each(function(index, linkToggle) {\n                var link = $(linkToggle);\n                var data = link.data('disableelements');\n                var disableElements = data.split(',');\n\n                for (index in disableElements) {\n                    var disableId = 'id_' + disableElements[index];\n                    if (t.dependencies[disableId] === undefined) {\n                        t.dependencies[disableId] = [];\n                    }\n                    t.dependencies[disableId].push($('#' + link.attr('for')));\n                }\n            });\n\n            linkToggles.click(function(e) {\n                e.preventDefault();\n                t.linkToggleHandler($(this));\n            }).keypress(function(e) {\n                if (e.keyCode === keyCodes.space) {\n                    e.preventDefault();\n                    t.linkToggleHandler($(this));\n                }\n            });\n\n            // Init.\n            t.initCalendarTabIndex();\n        },\n\n        /**\n         * Toggle property checked for a hidden checkbox.\n         *\n         * @param {jQuery} linkToggle\n         */\n        linkToggleHandler: function(linkToggle) {\n            var checkbox = $('.toggle#' + linkToggle.attr('for'));\n            var toggle = !checkbox.prop('checked');\n            checkbox.prop('checked', toggle);\n            var data = linkToggle.data('disableelements');\n\n            if (data.length > 0) {\n                var disableElements = data.split(','),\n                    index;\n\n                for (index in disableElements) {\n                    var disableId = 'id_' + disableElements[index];\n                    // Check depend on before disable.\n                    if (!toggle && t.checkDependOn(disableId)) {\n                        toggle = true;\n                    }\n\n                    $('#' + disableId).attr('disabled', toggle);\n                }\n            }\n        },\n\n        /**\n         * Check if an element depend on the check box by id.\n         *\n         * @param {String} id\n         * @returns {boolean}\n         */\n        checkDependOn: function(id) {\n            var dependOn = t.dependencies[id],\n                index;\n\n            for (index in dependOn) {\n                if (dependOn[index].prop('checked')) {\n                    return true;\n                }\n            }\n\n            return false;\n        },\n\n        /**\n         * Init Calendar Tab Index, should not tab-able when checkbox is not checked.\n         */\n        initCalendarTabIndex: function() {\n            $(t.SELECTOR.TIME_SDT.INPUT).change(function() {\n                var calendar = $(t.SELECTOR.TIME_SDT.CALENDAR);\n                var focus = $(t.SELECTOR.TIME_SDT.SELECT_DAY_CALENDAR);\n                var isCheck = $(this).is(\":checked\");\n                t.toggleCalendarTabIndex(calendar, focus, isCheck);\n            });\n            $(t.SELECTOR.TIME_EDT.INPUT).change(function() {\n                var calendar = $(t.SELECTOR.TIME_EDT.CALENDAR);\n                var focus = $(t.SELECTOR.TIME_EDT.SELECT_DAY_CALENDAR);\n                var isCheck = $(this).is(\":checked\");\n                t.toggleCalendarTabIndex(calendar, focus, isCheck);\n            });\n        },\n\n        /**\n         * Toggle tab index for calendar.\n         *\n         * @param {jQuery} calendar\n         * @param {jQuery} focusElement\n         * @param {Boolean} isCheck\n         */\n        toggleCalendarTabIndex: function(calendar, focusElement, isCheck) {\n            if (isCheck) {\n                calendar.removeAttr('tabindex');\n                focusElement.focus();\n            } else {\n                calendar.attr('tabindex', -1);\n            }\n        }\n    };\n\n    return t;\n});\n"],"names":["define","$","keyCodes","t","SELECTOR","TIME_EDT","CALENDAR","SELECT_DAY_CALENDAR","INPUT","TIME_SDT","dependencies","init","linkToggles","each","index","linkToggle","link","disableElements","data","split","disableId","undefined","push","attr","click","e","preventDefault","linkToggleHandler","this","keypress","keyCode","space","initCalendarTabIndex","checkbox","toggle","prop","length","checkDependOn","id","dependOn","change","calendar","focus","isCheck","is","toggleCalendarTabIndex","focusElement","removeAttr"],"mappings":";;;;;;;AAsBAA,gDAAO,CAAC,SAAU,mBAAmB,SAASC,EAAGC,cACzCC,EAAI,CAEJC,SAAU,CACNC,SAAU,CACNC,SAAU,oCACVC,oBAAqB,oCACrBC,MAAO,0CAEXC,SAAU,CACNH,SAAU,oCACVC,oBAAqB,oCACrBC,MAAO,2CAQfE,aAAc,GAKdC,KAAM,eACEC,YAAcX,EAAE,iBAEpBW,YAAYC,MAAK,SAASC,MAAOC,gBACzBC,KAAOf,EAAEc,YAETE,gBADOD,KAAKE,KAAK,mBACMC,MAAM,SAE5BL,SAASG,gBAAiB,KACvBG,UAAY,MAAQH,gBAAgBH,YACNO,IAA9BlB,EAAEO,aAAaU,aACfjB,EAAEO,aAAaU,WAAa,IAEhCjB,EAAEO,aAAaU,WAAWE,KAAKrB,EAAE,IAAMe,KAAKO,KAAK,aAIzDX,YAAYY,OAAM,SAASC,GACvBA,EAAEC,iBACFvB,EAAEwB,kBAAkB1B,EAAE2B,UACvBC,UAAS,SAASJ,GACbA,EAAEK,UAAY5B,SAAS6B,QACvBN,EAAEC,iBACFvB,EAAEwB,kBAAkB1B,EAAE2B,WAK9BzB,EAAE6B,wBAQNL,kBAAmB,SAASZ,gBACpBkB,SAAWhC,EAAE,WAAac,WAAWQ,KAAK,QAC1CW,QAAUD,SAASE,KAAK,WAC5BF,SAASE,KAAK,UAAWD,YACrBhB,KAAOH,WAAWG,KAAK,sBAEvBA,KAAKkB,OAAS,EAAG,KAEbtB,MADAG,gBAAkBC,KAAKC,MAAM,SAG5BL,SAASG,gBAAiB,KACvBG,UAAY,MAAQH,gBAAgBH,QAEnCoB,QAAU/B,EAAEkC,cAAcjB,aAC3Bc,QAAS,GAGbjC,EAAE,IAAMmB,WAAWG,KAAK,WAAYW,WAWhDG,cAAe,SAASC,QAEhBxB,MADAyB,SAAWpC,EAAEO,aAAa4B,QAGzBxB,SAASyB,YACNA,SAASzB,OAAOqB,KAAK,kBACd,SAIR,GAMXH,qBAAsB,WAClB/B,EAAEE,EAAEC,SAASK,SAASD,OAAOgC,QAAO,eAC5BC,SAAWxC,EAAEE,EAAEC,SAASK,SAASH,UACjCoC,MAAQzC,EAAEE,EAAEC,SAASK,SAASF,qBAC9BoC,QAAU1C,EAAE2B,MAAMgB,GAAG,YACzBzC,EAAE0C,uBAAuBJ,SAAUC,MAAOC,YAE9C1C,EAAEE,EAAEC,SAASC,SAASG,OAAOgC,QAAO,eAC5BC,SAAWxC,EAAEE,EAAEC,SAASC,SAASC,UACjCoC,MAAQzC,EAAEE,EAAEC,SAASC,SAASE,qBAC9BoC,QAAU1C,EAAE2B,MAAMgB,GAAG,YACzBzC,EAAE0C,uBAAuBJ,SAAUC,MAAOC,aAWlDE,uBAAwB,SAASJ,SAAUK,aAAcH,SACjDA,SACAF,SAASM,WAAW,YACpBD,aAAaJ,SAEbD,SAASlB,KAAK,YAAa,YAKhCpB"}