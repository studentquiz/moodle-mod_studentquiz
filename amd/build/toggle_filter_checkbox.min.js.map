{"version":3,"sources":["../src/toggle_filter_checkbox.js"],"names":["define","$","keyCodes","t","SELECTOR","TIME_EDT","CALENDAR","SELECT_DAY_CALENDAR","INPUT","TIME_SDT","dependencies","init","linkToggles","each","index","linkToggle","link","data","disableElements","split","disableId","push","attr","click","e","preventDefault","linkToggleHandler","keypress","keyCode","space","initCalendarTabIndex","checkbox","toggle","prop","length","checkDependOn","id","dependOn","change","calendar","focus","isCheck","is","toggleCalendarTabIndex","focusElement","removeAttr"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript to toggle filter checkbox.\n *\n * @module     mod_studentquiz/toggle_filter_checkbox\n * @package    mod_studentquiz\n * @copyright  2019 The Open University\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'core/key_codes'], function($, keyCodes) {\n    var t = {\n\n        SELECTOR: {\n            TIME_EDT: {\n                CALENDAR: \"a[name='timecreated_edt[calendar]\",\n                SELECT_DAY_CALENDAR: \"select[name='timecreated_edt[day]\",\n                INPUT: \"input[name='timecreated_edt[enabled]']\"\n            },\n            TIME_SDT: {\n                CALENDAR: \"a[name='timecreated_sdt[calendar]\",\n                SELECT_DAY_CALENDAR: \"select[name='timecreated_sdt[day]\",\n                INPUT: \"input[name='timecreated_sdt[enabled]']\"\n            }\n        },\n\n        /**\n         * Elements (jQuery) are depend on hidden checkboxes.\n         * They will disable if the checkbox is checked.\n         */\n        dependencies: [],\n\n        /**\n         * Initialise events on link-toggle.\n         */\n        init: function() {\n            var linkToggles = $('a.link-toggle');\n\n            linkToggles.each(function(index, linkToggle) {\n                var link = $(linkToggle);\n                var data = link.data('disableelements');\n                var disableElements = data.split(',');\n\n                for (index in disableElements) {\n                    var disableId = 'id_' + disableElements[index];\n                    if (t.dependencies[disableId] === undefined) {\n                        t.dependencies[disableId] = [];\n                    }\n                    t.dependencies[disableId].push($('#' + link.attr('for')));\n                }\n            });\n\n            linkToggles.click(function(e) {\n                e.preventDefault();\n                t.linkToggleHandler($(this));\n            }).keypress(function(e) {\n                if (e.keyCode === keyCodes.space) {\n                    e.preventDefault();\n                    t.linkToggleHandler($(this));\n                }\n            });\n\n            // Init.\n            t.initCalendarTabIndex();\n        },\n\n        /**\n         * Toggle property checked for a hidden checkbox.\n         *\n         * @param {jQuery} linkToggle\n         */\n        linkToggleHandler: function(linkToggle) {\n            var checkbox = $('.toggle#' + linkToggle.attr('for'));\n            var toggle = !checkbox.prop('checked');\n            checkbox.prop('checked', toggle);\n            var data = linkToggle.data('disableelements');\n\n            if (data.length > 0) {\n                var disableElements = data.split(','),\n                    index;\n\n                for (index in disableElements) {\n                    var disableId = 'id_' + disableElements[index];\n                    // Check depend on before disable.\n                    if (!toggle && t.checkDependOn(disableId)) {\n                        toggle = true;\n                    }\n\n                    $('#' + disableId).attr('disabled', toggle);\n                }\n            }\n        },\n\n        /**\n         * Check if an element depend on the check box by id.\n         *\n         * @param {String} id\n         * @returns {boolean}\n         */\n        checkDependOn: function(id) {\n            var dependOn = t.dependencies[id],\n                index;\n\n            for (index in dependOn) {\n                if (dependOn[index].prop('checked')) {\n                    return true;\n                }\n            }\n\n            return false;\n        },\n\n        /**\n         * Init Calendar Tab Index, should not tab-able when checkbox is not checked.\n         */\n        initCalendarTabIndex: function() {\n            $(t.SELECTOR.TIME_SDT.INPUT).change(function() {\n                var calendar = $(t.SELECTOR.TIME_SDT.CALENDAR);\n                var focus = $(t.SELECTOR.TIME_SDT.SELECT_DAY_CALENDAR);\n                var isCheck = $(this).is(\":checked\");\n                t.toggleCalendarTabIndex(calendar, focus, isCheck);\n            });\n            $(t.SELECTOR.TIME_EDT.INPUT).change(function() {\n                var calendar = $(t.SELECTOR.TIME_EDT.CALENDAR);\n                var focus = $(t.SELECTOR.TIME_EDT.SELECT_DAY_CALENDAR);\n                var isCheck = $(this).is(\":checked\");\n                t.toggleCalendarTabIndex(calendar, focus, isCheck);\n            });\n        },\n\n        /**\n         * Toggle tab index for calendar.\n         *\n         * @param {jQuery} calendar\n         * @param {jQuery} focusElement\n         * @param {Boolean} isCheck\n         */\n        toggleCalendarTabIndex: function(calendar, focusElement, isCheck) {\n            if (isCheck) {\n                calendar.removeAttr('tabindex');\n                focusElement.focus();\n            } else {\n                calendar.attr('tabindex', -1);\n            }\n        }\n    };\n\n    return t;\n});\n"],"file":"toggle_filter_checkbox.min.js"}