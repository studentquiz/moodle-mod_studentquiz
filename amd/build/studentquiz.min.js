/**
 * Javascript for save rating and save, remove and listing comments
 *
 * @module    mod_studentquiz/studentquiz
 * @copyright 2017 HSR (http://www.hsr.ch)
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("mod_studentquiz/studentquiz",["jquery"],(function($){return{initialise:function(forcerating,forcecommenting,isanswered){var ratingElements=$(".studentquiz_behaviour .rate .rating .rateable");ratingElements.off("click").on("click",(function(){addRating(this)})),ratingElements.on("keypress",(function(e){13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),addRating(this))})),$('input[name="next"], input[name="previous"], input[name="finish"]').off("click").on("click",(function(){var $that=$(this);if(isanswered){var hasrated=$(".rating span").hasClass("star"),hascommented=$(".studentquiz-comment-container").hasClass("has-comment");return forcerating&&!hasrated&&$(".studentquiz_behaviour > .rate > .rate_error").removeClass("hide"),forcecommenting&&!hascommented&&$(".studentquiz_behaviour > .comments .comment-error").removeClass("hide"),forcerating&&!hasrated?$(".studentquiz_behaviour .rate .rating .rateable:first-child").focus():forcecommenting&&!hascommented&&$(".studentquiz_behaviour .comments .studentquiz-comment-container .editor_atto_content").focus(),!(forcerating&&!hasrated||forcecommenting&&!hascommented)&&($that.submit(),!0)}return $that.submit(),!0}))},setFocus:function(){$(document).ready((function(){var sortIcon=$("#categoryquestions .iconsort");sortIcon&&sortIcon.parent().focus()}))},selectAllQuestions:function(){let headerCheckbox=document.getElementById("qbheadercheckbox");require(["core/checkbox-toggleall"],(()=>{headerCheckbox.checked||headerCheckbox.click()}))}};function addRating(element){var $element=$(element),rate=$element.attr("data-rate"),$that=$element,cmid=$element.closest("form").find(".cmid_field").attr("value");$.post(M.cfg.wwwroot+"/mod/studentquiz/save.php",{save:"rate",cmid:cmid,studentquizquestionid:$element.attr("data-studentquizquestionid"),sesskey:M.cfg.sesskey,rate:rate},(function(){var $ratingStars=$that.closest(".rating").children("span");$ratingStars.removeClass("star"),$ratingStars.addClass("star-empty"),$ratingStars.each((function(){$(this).attr("data-rate")<=rate&&($(this).removeClass("star-empty"),$(this).addClass("star"))})),$(".studentquiz_behaviour > .rate > .rate_error").addClass("hide")}))}}));

//# sourceMappingURL=studentquiz.min.js.map